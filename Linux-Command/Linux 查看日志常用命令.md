# Linux 查看日志常用命令

## tail

`tail`命令可以用来查看一个文件内容。常用的参数`-f`常用于查阅正在改变的日志文件，常用的参数`-n`用于从文件的最后n行开始查阅。

例如：

* 查看日志文件的最后100行

	```sh
	tail -n 100 /var/log/mail.log
	```

* 实时从日志文件中获取所有新添加的行

	```sh
	tail -f /var/log/mail.log
	```
	**提示：** 按`[ctrl]+[c]`来退出`tail`命令并回到命令行。

* 如果想从日志文件中获取最后1000行，并且它们不适合在shell窗口全部展示，则可以使用命令`more`来逐行查看它们。

	```sh
	tail -n 1000 /var/log/mail.log | more
	```
	**提示：** 按`空格`转到下一行或者按`[ctrl]+[c]`来退出。

* 如果想在大文件中搜索特定的词，可以使用`grep`命令

	```sh
	grep "tom@anydomain.tld" /var/log/mail.log
	```

## cat

`cat`命令可以用来查看文件的全部内容。

```sh
cat /var/log/mail.log
```

## less

`less`命令可以用来随意浏览文件，而且`less`在查看之前不会加载整个文件。

### 语法

```sh
less [参数] 文件 
```

**参数说明：**

* -b <缓冲区大小> 设置缓冲区的大小
* -e 当文件显示结束后，自动离开
* -f 强迫打开特殊文件，例如外围设备代号、目录和二进制文件
* -g 只标志最后搜索的关键词
* -i 忽略搜索时的大小写
* -m 显示类似more命令的百分比
* -N 显示每行的行号
* -o <文件名> 将less 输出的内容在指定文件中保存起来
* -Q 不使用警告音
* -s 显示连续空行为一行
* -S 行过长时间将超出部分舍弃
* -x <数字> 将"tab"键显示为规定的数字空格
* /字符串：向下搜索"字符串"的功能
* ?字符串：向上搜索"字符串"的功能
* n：重复前一个搜索（与 / 或 ? 有关）
* N：反向重复前一个搜索（与 / 或 ? 有关）
* b 向后翻一页
* d 向后翻半页
* h 显示帮助界面
* Q 退出less 命令
* u 向前滚动半页
* y 向前滚动一行
* 空格键 滚动一页
* 回车键 滚动一行
* [pagedown]： 向下翻动一页
* [pageup]： 向上翻动一页

### 附加备注

1. 全屏导航

	* ctrl + F - 向前移动一屏
	* ctrl + B - 向后移动一屏
	* ctrl + D - 向前移动半屏
	* ctrl + U - 向后移动半屏

2. 单行导航

	* j - 向前移动一行
	* k - 向后移动一行

3. 其它导航

	* G - 移动到最后一行
	* g - 移动到第一行
	* q / ZZ - 退出 less 命令

4. 其它有用的命令

	* v - 使用配置的编辑器编辑当前文件
	* h - 显示 less 的帮助文档
	* &pattern - 仅显示匹配模式的行，而不是整个文件

5. 标记导航

	当使用 less 查看大文件时，可以在任何一个位置作标记，可以通过命令导航到标有特定标记的文本位置：

	* ma - 使用 a 标记文本的当前位置
	* 'a - 导航到标记 a 处

## more

`more`以一页一页的形式显示，更方便使用者逐页阅读。

### 语法

```sh
more [-dlfpcsu] [-num] [+/pattern] [+linenum] [fileNames..]
```

**参数说明：**

* -num 一次显示的行数
* -d 提示使用者，在画面下方显示 [Press space to continue, 'q' to quit.] ，如果使用者按错键，则会显示 [Press 'h' for instructions.] 而不是 '哔' 声
* -l 取消遇见特殊字元 ^L（送纸字元）时会暂停的功能
* -f 计算行数时，以实际上的行数，而非自动换行过后的行数（有些单行字数太长的会被扩展为两行或两行以上）
* -p 不以卷动的方式显示每一页，而是先清除萤幕后再显示内容
* -c 跟 -p 相似，不同的是先显示内容再清除其他旧资料
* -s 当遇到有连续两行以上的空白行，就代换为一行的空白行
* -u 不显示下引号 （根据环境变数 TERM 指定的 terminal 而有所不同）
* +/pattern 在每个文档显示前搜寻该字串（pattern），然后从该字串之后开始显示
* +num 从第 num 行开始显示
* fileNames 欲显示内容的文档，可为复数个数

### 实例

* 逐页显示 testfile 文档内容，如有连续两行以上空白行则以一行空白行显示。

	```sh
	more -s testfile
	```

* 从第 20 行开始显示 testfile 之文档内容。

	```sh
	more +20 testfile
	```

### 常用操作命令

* Enter 向下n行，需要定义。默认为1行
* Ctrl+F 向下滚动一屏
* 空格键 向下滚动一屏
* Ctrl+B 返回上一屏
* = 输出当前行的行号
* ：f 输出文件名和当前行的行号
* V 调用vi编辑器
* !命令 调用Shell，并执行命令
* q 退出more



